<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <script type="module">
            const url = 'https://bibkg.imfd.cl/websocket';
            // try {
            //     const ws = new WebSocket(url);
            //     ws.onopen = (event) => console.log('onopen', event);
            //     ws.onerror = (event) => console.log('onerror', event);
            //     ws.onclose = (event) => console.log('onclose', event);
            //     console.log(ws.readyState);
            //     ws.close();
            // } catch (err) {
            //     console.log('CATCHED', err);
            // }

            // const newWs = new WebSocket(url);

            // setTimeout(() => {
            // newWs.close();
            // }, 1000);
            // Direct reference non-minified
            import MillenniumDB from '/lib/browser/index.esm.js';

            const driver = MillenniumDB.driver('ws://localhost:1234');
            const session = driver.session();

            // console.log(await driver.catalog());

            const result = session.run('MATCH (?src)-[?rel :?type]->(?dst) RETURN *');

            result.records().then(async (results) => {
                console.log(await result.variables());
                console.log(results);
            });

            // let myVariables;
            // result.subscribe({
            //     onVariables: (variables) => {
            //         console.log('onVariables', variables);
            //         myVariables = variables;
            //     },
            //     onRecord: (record) => {
            //         // console.log('onRecord', record);
            //     },
            //     onSuccess: (summary) => {
            //         console.log('onSuccess', summary);
            //         session.close();
            //     },
            //     onError: (error) => {
            //         console.log('onError', error);
            //         session.close();
            //     },
            // });

            // setTimeout(async () => {
            //     console.log('before cancel');
            //     const cancelResult = await driver.cancel(result);
            //     console.log('cancelResult', cancelResult);
            // }, 1000);
        </script>
    </body>
</html>
